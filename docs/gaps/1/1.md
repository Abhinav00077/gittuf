# The gittuf Augmentation Proposal (GAP) Format

## Metadata

* **Number:** 1
* **Title:** The gittuf Augmentation Proposal (GAP) Format
* **Status:** Draft
* **Sponsors:** Aditya Sirish A Yelgundhalli (adityasaky)
* **Contributors:** Patrick Zielinski (patzielinski)
* **Reviewers:** TBD
* **Related GAPs:** None
* **Last Modified:** January 17, 2025

## Abstract

A gittuf Augmentation Proposal (GAP) is a document that describes new features,
extensions, or changes to the gittuf design document. GAPs are not meant to
handle changes to the gittuf community processes, structure, or governance; such
changes are handled in the gittuf/community repository.  This document describes
the structure of GAP documents as well as the process by which GAPs must be
submitted and approved.

## Specification

GAP stands for gittuf Augmentation Proposal. A GAP is a design document that
describes new features, extensions, or changes to the gittuf design document. A
GAP provides a concise technical specification of the feature, describes the
motivation for the change, and discusses the rationale behind the design. A GAP
cannot be used to propose changes to gittuf community processes, structure, or
governance. The only exception is the GAP process itself, which are handled by
changes to this document.  Other process-related changes must instead be
proposed to the gittuf/community repository.

### GAP Roles and Responsibilities

The GAP workflow encompasses several roles.

#### Sponsor

Every GAP must have at least one sponsor. There is no limit to the number of
sponsors a GAP may have, though it cannot include a majority of gittuf
maintainers. Each sponsor must be listed in the GAP's metadata section.

#### Contributor

A GAP may have one or more contributors. These are members of the community who
contribute to the GAP but do not wish to sponsor it. As such, they do not have
the responsibilities of a GAP sponsor.  Each contributor must be listed in the
GAP's metadata section.

A sponsor may also be relisted as a contributor if they cannot continue
sponsoring the GAP. In this case, they may optionally be credited as a former
sponsor when listed as a contributor. Note that the limit on number of
maintainers sponsoring a GAP extends to former sponsors as well. Suppose Alice,
Bob, Carol, Dana, and Eric are gittuf's maintainers. If Alice and Bob sponsor a
GAP but Alice then chooses to re-list herself as a former sponsor in the
contributors section, none of Carol, Dana, and Eric can join Bob as a sponsor of
the GAP.

#### Reviewer

A GAP may have one or more reviewers who provide feedback to the proposed
changes. A reviewer cannot be a sponsor or a contributor (thus excluding former
sponsors as well), and may be either a gittuf maintainer or another community
member. Each reviewer must be listed in the metadata section of the GAP's
metadata section.  Additionally, the reviewer's name may be followed by a
mention of the GAP statuses at which they reviewed the GAP. For example, `Alice
(draft), Bob (draft, accepted), Carol (accepted, implemented)` indicates that
Alice only reviewed at the draft status, Bob reviewed at the draft status and
when the GAP moved to accepted status, and Carol reviewed when the GAP moved to
the accepted status and when it moved to the implemented status.

### GAP Statuses

A GAP document must have one of the following statuses.

1. **Draft:** The initial status of a GAP document, when it's first proposed and
is under active discussion and development.
1. **Accepted:** After the GAP is merged as a draft, the maintainers may choose
to accept the proposed changes. At this point, the GAP need not have been
implemented, though a prototype is necessary.
1. **Implemented:** After an accepted GAP is implemented in gittuf, the document
moves to this status. Note that an implementation marked as experimental or
released as part of the developer mode do not suffice for a GAP to move to the
implemented status.
1. **Withdrawn:** The status of a GAP document when the sponsor chooses to
withdraw the draft proposal. This may be because the changes are a bad idea or
another GAP is preferable. To preserve a record of the proposal, the GAP should
still be merged into the repository with this status.
1. **Rejected:** The status of a GAP document when the gittuf maintainers reject
the proposed changes. To preserve a record of the proposal, the GAP should still
be merged into the repository with this status.
1. **Removed:** If a GAP is implemented but the corresponding changes are
removed from the implementation at a future date, the GAP must be moved to this
status.

### GAP Workflow

A GAP typically goes through the following workflows that determine how its
status changes.

#### Discuss the problem

A GAP solves specific problems that the gittuf design currently does not. Rather
than directly approach the community with a draft GAP, it is a good idea to
discuss with the maintainers and the broader community the problem itself. This
can help confirm that the problem in fact exists (instead of being a
misunderstanding of the gittuf design), has not already been explored in a
previous GAP, and a solution ought to be part of gittuf (rather than another
complementary system). This discussion may happen in any forum used by the
gittuf community, though the repository's issue tracker is recommended for
maximum visibility.

#### Propose the GAP

After the maintainers agree that a GAP is required, one or more sponsors can
author a draft of the GAP. To submit a GAP, one of the sponsors must open a pull
request with the document to the gittuf repository. The GAP must follow the
format specified in this document (or copy the template provided alongside this
document), minus the number as that is assigned when the document is merged.

#### Merging GAP as draft

After a discussion of the GAP's pull request, a GAP may be merged as a draft
with approval from at least one gittuf maintainer who is not also a sponsor of
the GAP. The maintainer must be listed as a reviewer in the GAP, and the GAP
must also be updated with the latest available number.

#### Accepting a draft GAP

When the sponsor(s) or gittuf maintainers decide a GAP is ready to be accepted,
a pull request may be opened to update the status of the document. For a GAP to
be accepted, it must include at least a prototype implementation of the proposed
changes. The prototype implementation may be in the gittuf implementation or in
a fork. If the prototype is in the gittuf implementation, it must be marked as
experimental or only available in gittuf's developer mode. The GAP only moves to
accepted status when a majority of gittuf maintainers eligible to be the GAP's
reviewers approve.

Suppose Alice, Bob, Carol, Dana, and Eric are gittuf's maintainers. For a GAP to
be accepted, at least three of them must approve. If Alice and Bob sponsor a
GAP, then all three of Carol, Dana, and Eric must approve the GAP for it to be
accepted. The majority requirement **does not** mean only a majority of Carol,
Dana, and Eric must approve the change, but rather a majority of gittuf
maintainers as a whole.

#### Implementing an accepted GAP

The changes proposed in a GAP may be implemented via patches to the gittuf
implementation. The changes to the implementation need not be submitted by the
sponsor(s) of the GAP. When the sponsor(s) or gittuf maintainers think a GAP is
ready to be moved to the implemented status, they can propose an update to the
document via a pull request to the repository. The GAP must be updated with the
relevant details, and a majority of gittuf maintainers must approve that the GAP
has in fact been implemented. As before, this  majority must be achieved with
non-sponsor maintainers.

It could be the case that a GAP is sponsored by some maintainers and implemented
by other maintainers such that a majority of maintainers may no longer be
neutral parties in deciding whether a GAP can be considered as implemented. In
such cases, the maintainers who sponsor the GAP and those who implement the GAP
must first achieve consensus that the implementation matches the GAP's
specification (e.g., by having the sponsoring maintainers review the
implementation). The implementing maintainers can then serve as reviwers in
determining if the GAP can be considered as implemented.  Further, the
implementation section of the GAP must include a disclaimer indicating that one
or more reviewers were also responsible for implementing the GAP.

#### Updating an accepted GAP

A GAP that has already been accepted may still be updated. All changes must be
approved by a majority of gittuf maintainers eligible to serve as the GAP's
reviewers.

#### Updating an implemented GAP

After a GAP has been implemented, there are several scenarios where the document
needs to be updated.

##### The implementation is changed such that it no longer matches the GAP's specification

The implementation of a GAP may be updated such that it diverges from the GAP's
specification. If the change is minor (e.g., a workflow update that is backwards
compatible with the originally implemented GAP), the GAP must be updated to
document the change. This update must include the reasoning for the new change,
a description of the change in the implementation section, as well as a new
changelog entry. The GAP may keep its implemented status.

If the change is significant (e.g., it's backwards incompatible with the
original implemented GAP), the gittuf maintainers may use their discretion to
determine the best way forward. This includes and is not limited to requiring
the GAP to be marked as removed, with a new GAP proposed that matches the new
implementation.

##### The feature or proposed changes are removed entirely from the implementation

[See the corresponding workflow](#removing-a-gaps-implementation).

#### Withdrawing a GAP

The sponsors of a GAP may choose to withdraw their proposal based on discussions
of the draft GAP. If the sponsor chooses to withdraw before the GAP is merged as
draft, the GAP should still be merged (with the latest available number) but
directly with the withdrawn status.  If the sponsor chooses to withdraw after a
GAP is merged as draft, the GAP must be updated to indicate the new status, with
an entry in the changelog.  In either case, the reasoning section of the GAP
must summarize the reason for withdrawing the GAP.

A GAP must only be withdrawn on the basis of technical reasons (e.g., a better
solution is proposed or a security issue is discovered as a consequence of the
proposal). A GAP must not move to this status due to resource constraints (e.g.,
the time to work on sponsoring or implementing the GAP) on the part of the
sponsors. In such cases, the GAP must remain in its draft status and the
sponsors or gittuf maintainers may choose to put out a call to action in the
gittuf communnity for other parties to sponsor the GAP. Additionally, only a
draft GAP may be withdrawn.

#### Rejecting a GAP

The non-sponsor gittuf maintainers may choose to reject the GAP. This must be on
the basis of technical reasons (e.g., in favor of a better solution or due to
security concerns). The reasoning of the GAP must indicate the reason for
rejection. If the GAP is rejected when it is first proposed, prior to being
merged as draft, it should still be merged (with the latest available number
assigned to it) but directly with the rejected status. If a draft or accepted
GAP that has already been merged is rejected, it must be updated with the new
status and a corresponding entry in the changelog section.

#### Removing a GAP's implementation

If a GAP's implementation is removed with no replacements, then the GAP must be
updated to indicate this change. The reasoning, backwards compatibility,
implementation, and changelog sections must all be updated. For a GAP to move to
the removed status, a majority of gittuf maintainers must approve as the change
is likely to be backwards incompatible.

In the scenario where the gittuf maintainers suggest marking a GAP as removed
due to a significant change to its implementation, this must also be documented
in the GAP. A new GAP must be proposed that matches the changed implementation,
and this new GAP must mark the removed GAP as a related GAP in the metadata
section. The logistics of this process are left to the gittuf maintainers to
determine on a case-by-case basis.

### GAP Format

All GAPs must have the following sections to be merged into the gittuf
repository with "draft" status.

1. **Metadata:** A list at the very top of a GAP that contains the GAP's number,
title, status, sponsors, contributors, reviewers, related GAPs and the date it
was last modified.
1. **Abstract:** A short description of the GAP.
1. **Specification:** The technical specification of the proposed changes or
additions to the gittuf design.
1. **Motivation:** A description of the motivation for the proposed changes. The
motivation may precede the specification section in cases the context it
provides is important to reason about the specification.
1. **Reasoning:** A discussion of the reasoning behind specific design or
architectural decisions proposed in the specification. The sponsors should also
try and include summaries of discussions from the community related to these
decisions (perhaps raised on the pull request proosing the GAP or in synchronous
discussions in gittuf community meetings).
1. **Backwards Compatibility:** A discussion of how the proposed changes impact
the backwards compatibility of gittuf's design and implementation. If a GAP does
not break backwards compatibility, that must be stated explicitly.
1. **Security:** As gittuf is fundamentally a security project, any changes to
gittuf's design must be considered carefully with respect to how it changes the
security model of the project. Each GAP must discuss the security impact of the
proposed changes, potential issues that may arise as a consequence of the
proposed changes, their mitigations, and any implementation-specific footguns
developers must be mindful of.
1. **Changelog:** Every time a change to a GAP is **merged** into the
repository, an entry must be added to this section with a brief summary of the
changes and the date they were made. This section may be omitted for the very
first iteration of a GAP.
1. **References:** A list of references that include links to discussions
pertaining to the GAP as well as any external links relevant to the proposed
changes.

A draft GAP may also include the following sections. These are optional.

1. **Prototype Implementation:** A description or link to a prototype of the
proposed changes.
1. **Acknowledgements:** Any relevant acknowledgements to people (who are not
sponsors, contributors, or reviewers of the GAP) or projects (that in some way
inspired the GAP).

In addition to the fields described at the draft status, a GAP must have the
following sections to be moved to "accepted" status.

1. **Prototype Implementation:** A description or link to a prototype of the
proposed changes.

In addition to the fields described at the accepted status, a GAP must have the
following sections to be moved to "implemented" status.

1. **Implementation:** A description of how the GAP was implemented in gittuf.
If a prototype implementation was accepted as the final implementation, this
section may just indicate as such and refer to the prototype implementation
section.

If the features proposed in an implemented GAP are later removed, the GAP must
be updated to indicate the "removed" status. The GAP's reasoning must also be
updated to indicate why the feature was removed.

### Achieving Consensus

## Motivation

gittuf is an implementation-first project, unlike sister projects like in-toto
and TUF that are primarily specification projects. However, gittuf's
implementation includes a design document that describes how different aspects
of gittuf work (e.g., communication with forges, verification and recovery
workflows, etc.). Despite not being a specification, the design document ensures
gittuf's features are developed in a reasoned manner, which is especially
important as gittuf is a security project. The introduction of GAPs ensures that
changes to gittuf's design are similarly developed in a reasoned manner with
input from gittuf maintainers and community members alike.

## Reasoning

A formal enhancement process of some variety is commonplace in many open source
communities (Python, Jenkins, Tekton, etc.). The GAPs process is modeled most
closely on the processes employed by the in-toto and TUF communities.

### GAP Roles

The GAP process has three roles: sponsors, contributors, and reviewers. These
three roles ensure that a GAP documents all of the parties who take part in
developing and moving the GAP along. Collectively, these roles encompass the
different responsibilities envisioned for taking an idea all the way to it being
implemented in gittuf. However, as this process is employed, more roles or
additional responsibilities may be required. In such cases, this document will
be updated with the required changes, subject to approval from the gittuf
maintainers.

The different GAP roles also place some restrictions on how many maintainers can
serve as sponsors. These restrictions have been placed to ensure that a
sufficient number of gittuf maintainers can serve as neutral reviewers for
changes either to a GAP or its implementation. These restrictions may not
address all scenarios, and other restrictions may be added as necessary, subject
to approval from gittuf maintainers.

### GAP Formatting

Each GAP document must be a markdown file based on the provided template. The
gittuf project uses markdown for its design document and other documents, and
its ease of use and broad support (in editors, on forges such as GitHub, etc.)
makes it a good candidate. No specific formatting guidelines are prescribed as
they tend to be contentious. That said, a GAP's reviewers may suggest
formatting-related changes for consistency and readability.

## Backwards Compatibility

This GAP does not affect gittuf's backwards compatibility. However, extensions
will be refiled as GAPs, which will necessitate updating any links to the old
documents.

## Security

This GAP does not impact the security of gittuf intrinsically as it merely
describes how changes to gittuf's design must be proposed. The security impact
of each proposed change is addressed by the corresponding GAP.

## Acknowledgements

The GAP format and process borrows heavily from similar mechanisms in the
in-toto (in-toto Enhancements) and TUF (TUF Augmentation Proposals) communities.

## References

* [gittuf Design Document](/docs/design-document.md)
* [gittuf Maintainers](/MAINTAINERS.txt)
* [gittuf/community](https://github.com/gittuf/community)
* [gittuf Technical Steering Committee](https://github.com/gittuf/community/blob/main/TECHNICAL-STEERING-COMMITTEE.md)
* [GAP Template](/docs/gaps/1/template.md)
* [in-toto Enhancements (ITE)](https://github.com/in-toto/ite)
* [TUF Augmentation Proposals (TAPs)](https://github.com/theupdateframework/taps)
